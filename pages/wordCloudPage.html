<div id="wordCloudPage">
    
    <h1 id="wordCloudTitle">Word Cloud Page</h1>
    
    <div id="wordCloud"></div>
    
    <div id="artistSearchBar"></div>
    
    <div class="left">
        
        
        <input type="button" id="search" class="button" value="Search" disabled="true" />
    </div>
    
    <div class="center">
        <input type="button" id="add"  class="button" value="Add" disabled="true" />
    </div>
    
    
    
    
    <div class="right">
        <input type="button" id="share" class="button" value="Share" disabled="true" />
        
        
    </div>
    
</div>



<style>
    
    body {
        background-color: gray;
    }

div.relative {
    position: relative;
    width: 40px;
    height: 20px;
    border: 3px solid #73AD21;
}
h1 {
    text-align: center;
    left: 0;
    line-height: 200px;
    margin: auto;
    margin-top: -100px;
    position: absolute;
    top: 30%;
    width: 100%;
}
.button {
    position: relative;
    background-color: purple;
    border: none;
    color: black;
    padding: 13px 25px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 14px;
    margin: 4px 2px;
    cursor: pointer;
}


.right {
    text-align: center;
    left: 10;
    line-height: 200px;
    margin: auto;
    margin-top: -100px;
    position: absolute;
    top: 55%;
    width: 120%;
}

.center {
    text-align: center;
    left: 10;
    line-height: 200px;
    margin: auto;
    margin-top: -100px;
    position: absolute;
    top: 55%;
    width: 100%;
}

.left {
    text-align: center;
    left: 10;
    line-height: 200px;
    margin: auto;
    margin-top: -100px;
    position: absolute;
    top: 55%;
    width: 80%;
}




    </style>

<script>
	
	///
	//FUNCTIONS:
	///
	
	function generateLyricsCloud() {
		
		// TODO: generate lyrics cloud from 'songs' global var
		// put HTML lyrics cloud in #wordCloud element
		// save lyrics cloud image in case of sharing
		
		$("#wordCloud").html("<a class='wordCloudLink' value='word' style='color:purple'>" + songs[0].lyrics + "</a>"); // temporary
		
		$(".wordCloudLink").click(function() {
			word = $(this).attr("value");
			
			loadPage("songList");
		})
		
		$("#share").removeProp("disabled");
	}
	
	// Call this function when the page first loads and then whenever an artist is searched/added
	function queryArtists(artistsToQuery) {
	
		// Set the title (of document and header)
		var title = ""
		$.each(artists, function(index, artist) {
			title += ", " + artist.name;
		});
		title = title.substring(2);
		
		document.title = title;
		$("#wordCloudTitle").text(title);
	
		// TODO: set a good loading animation (like a spinning wheel)
		$("#wordCloud").html("<h3 style='color:red'>Loading...</h3>");
		$("#share").attr("disabled", true);
			
		// Make the parameter object
		
		console.log(artistsToQuery);
		
		var ids = [];
		$.each(artistsToQuery, function(key, value) {
			ids.push(value.chartLyricsID);
		})
			
		// Load the lyrics and generate the word cloud
		$.ajax({ // Load artist lyrics
			url: noServer ? "ajax/artistSongs_debug.json" : "ajax/artistSongs.php",
			data: {ids: ids}, // TODO: fix this parameter
			dataType: "json",
			success: function(data) {
				
				// save the results
				$.each(data, function(index, song) {
					songs.push(song);
				})
				
				generateLyricsCloud()
			}
		});
	}
	
	// Call this function when the page first loads and then whenever an artist searched
	function searchArtists(a) {
		
		artists = a;
		songs = [];
		
		queryArtists(a);
	}

	// Call this function whenever an artist is added
	function addArtist(a) {
	
		// Don't add an artist that we already have
		if ($.inArray(a, artists) >= 0) {
			return;
		}
	
		artists.push(a);
		
		queryArtists([a]);
	}
	
	///
	//ON LOAD:
	///
	
	// Initialize the lyrics cloud
	if (songs.length > 0) { // we're coming back to this page
		generateLyricsCloud();
	} else { // first time to this page
		searchArtists(artists);
	}
	
	// Set up the Artist Search Bar
	$("#artistSearchBar")
		.load("components/artistSearchBar.html")
		.on("yesSelection", function() {		
			$("#search").removeProp("disabled");
			$("#add").removeProp("disabled");
		})
		.on("noSelection", function() {
			$("#search").attr("disabled", true);
			$("#add").attr("disabled", true);
		});

	// Set up the Search Button
	$('#search').click(function() {
		
		$("#artistSearchBar").trigger('clear');
		
		var artistID = $("#artistSearchBar").attr("value");
		searchArtists([allArtists[artistID]]);
	});
	
	// Set up the Add Button
	$('#add').click(function() {
		
		$("#artistSearchBar").trigger('clear');
		
		var artistID = $("#artistSearchBar").attr("value");
		addArtist(allArtists[artistID]);
	});

	// Set up the Share Button
	$("#share").click(function() {
		
		// TODO: Share to Facebook
		alert("Share to Facebook!");
	});
	
</script>
